(this["webpackJsonpsub-editor"]=this["webpackJsonpsub-editor"]||[]).push([[0],{121:function(e){e.exports=JSON.parse('{"name":"sub-editor","version":"1.0.2","private":false,"homepage":"./","repository":{"type":"git","url":"https://github.com/Shirtiny/SubEditor"},"dependencies":{"@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.5.0","@testing-library/user-event":"^7.2.1","bootstrap":"^4.4.1","duration-time-conversion":"^1.0.1","flv.js":"^1.5.0","font-awesome":"^4.7.0","joi-browser":"^13.4.0","lodash":"^4.17.15","normalize.css":"^8.0.1","nprogress":"^0.2.0","react":"^16.13.0","react-dom":"^16.13.0","react-dplayer":"^0.3.3","react-helmet":"^6.0.0","react-i18nify":"^3.1.5","react-router-dom":"^5.1.2","react-scripts":"3.4.0","react-toastify":"^5.5.0","react-virtualized":"^9.21.2","shwave":"^1.7.4","styled-components":"^5.0.1"},"scripts":{"start":"cross-env PORT=2020 react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"gh-pages":"^2.2.0"}}')},132:function(e,n,t){e.exports=t(232)},227:function(e,n,t){},232:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(27),i=t.n(o),l=t(92);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=t(3),s=t(2),u=t(14),d=t(9),m=t(15),p=t(50),b=t(23),f=t(40),h=t(24),g=t(26),v=t(18),y=t.n(v),x=t(33),w=t(12),S=t(13),E=t(39),k="off"===E.log;var T={clog:function(){var e;k||(e=console).log.apply(e,arguments)}},C=function(){function e(n,t,a){Object(c.a)(this,e),this.start=Number(n.toFixed(3)),this.end=Number(t.toFixed(3)),this.content=a,this.editing=!1}return Object(s.a)(e,[{key:"startTime",get:function(){return ce.toTime(this.start)}},{key:"endTime",get:function(){return ce.toTime(this.end)}},{key:"length",get:function(){return Number((this.end-this.start).toFixed(3))}}]),e}(),O=t(51),j=t.n(O);var N={number2Time:function(e){var n=e.toFixed(3);return j.a.d2t(n)},time2Number:function(e){return j.a.t2d(e).toFixed(3)},getTimeLength:function(e,n){return(j.a.t2d(n)-j.a.t2d(e)).toFixed(3)}},A=t(44),I=t(36),_=t.n(I),R=t(120),B=t.n(R),U=/^\d+:[0-5][0-9]:[0-5][0-9](\.[0-9]{1,3})?$/,P={startTime:_.a.string().regex(U).required().min(8).label("\u5f00\u59cb\u65f6\u95f4"),endTime:_.a.string().regex(U).required().min(8).label("\u7ed3\u675f\u65f6\u95f4"),content:_.a.string().required().max(100).min(1).label("\u6587\u672c\u5185\u5bb9"),start:_.a.number(),end:_.a.number(),length:_.a.number().greater(0)},F="\u683c\u5f0f\u5982 00:00:29.320\u683c\u5f0f\uff0c\u53ef\u4ee5\u4e0d\u5e26\u5c0f\u6570\uff0c\u6700\u5c118\u4e2a\u5b57\u7b26",z="\u683c\u5f0f\u5982 00:00:29.320\uff0c\u53ef\u4ee5\u4e0d\u5e26\u5c0f\u6570\uff0c\u6700\u5c118\u4e2a\u5b57\u7b26",L="\u9700\u8981\u57281-100\u4e2a\u5b57\u7b26\u4e4b\u95f4\uff0c\u4e0d\u80fd\u4e3a\u7a7a",D="\u5fc5\u987b\u4e3a\u6570\u5b57",W="\u5fc5\u987b\u4e3a\u6570\u5b57",M="\u4e0d\u80fd\u4e3a\u8d1f\u503c\u62160\uff0c\u5f00\u59cb\u65f6\u95f4\u8981\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4",V={startTime:"\u5f00\u59cb\u65f6\u95f4",endTime:"\u7ed3\u675f\u65f6\u95f4",content:"\u5b57\u5e55\u6587\u672c\u5185\u5bb9",start:"\u8d77\u59cb\u79d2\u6570",end:"\u7ed3\u675f\u79d2\u6570",length:"\u65f6\u957f"};var H={abortEarly:!1,allowUnknown:!0,skipFunctions:!0};function q(e,n,t,a){var r=Object(A.a)({},e,n),o=Object(h.a)({},H,{abortEarly:!0},a);return!!_.a.validate(r,t,o).error}var $={schema:P,getEditingSubSchema:function(){return{startTime:P.startTime,endTime:P.endTime,content:P.content,start:P.start,end:P.end,length:P.length}},getEditingErrorSchema:function(){return{startTime:F,endTime:z,content:L,start:D,end:W,length:M}},validate:function(e,n,t){var a=Object(h.a)({},H,{},t),r=_.a.validate(e,n,a).error;if(!r)return!1;T.clog("editingSub\u6821\u9a8c\u7ed3\u679c\uff0c\u51fa\u73b0\u7684\u9519\u8bef\uff1a",r);var o=[];return r.details.map((function(e){return o.push(e.path[0])})),B.a.uniq(o)},validateProperty:q,errors2messages:function(e){if(!e)return[];var n=Object.keys(e).map((function(n){return V[n]+": "+e[n]}));return 0===n.length&&n.push(" "),n},validateTime:function(e){return q("startTime",e,{startTime:P.startTime})}},G=E.sub_storage_key||"DefaultSubs";function J(e){return Number(N.time2Number(e))}function Y(e,n){return Number(N.getTimeLength(e,n))}function Z(e,n,t){var a=new FileReader;a.readAsText(t),a.onerror=function(e){n(e)},a.onload=function(){e(a.result)}}function K(){return(K=Object(x.a)(y.a.mark((function e(n){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,new Promise((function(e,t){return Z(e,t,n)}));case 4:t=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),T.clog("\u5b57\u5e55\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff1b",e.t0),e.t0.message="\u5b57\u5e55\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff1b",e.t0;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function Q(e,n,t){var a=document.createElement("video"),r=document.createElement("track");a.appendChild(r),r.default=!0,r.kind="metadata",r.src=t,r.onerror=function(e){n(e)},r.onload=function(){e(r.track.cues)}}function X(){return(X=Object(x.a)(y.a.mark((function e(n){var t,a,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,new Promise((function(e,t){return Q(e,t,n)}));case 4:t=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),T.clog("\u5b57\u5e55\u88c5\u8f7d\u5931\u8d25\uff1a",e.t0),e.t0.message="\u5b57\u5e55\u88c5\u8f7d\u5931\u8d25",e.t0;case 12:return a=Array.from(t||{}),T.clog("\u5f97\u5230VTTCues\u6570\u7ec4\uff1a",a),r=a.map((function(e){return new C(e.startTime,e.endTime,e.text)})),o=r.map((function(e){return ne(e)})),T.clog("\u5f97\u5230\u5b57\u5e55\u6570\u7ec4\uff1a",o),e.abrupt("return",o);case 18:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function ee(e){var n=new Blob([e],{type:"text/vtt"});return T.clog("vtt\u5b57\u5e55Blob\u5bf9\u8c61",n),URL.createObjectURL(n)}function ne(e){var n=ae(e.startTime),t=ae(e.endTime);return{start:J(n),startTime:n,end:J(t),endTime:t,length:Y(n,t),content:e.content}}function te(){return new Promise((function(e,n){return function(e,n){var t=localStorage.getItem(G);try{e(JSON.parse(t)||[])}catch(a){T.clog("\u8bfb\u53d6local\u540e\uff0cJson\u89e3\u6790\u51fa\u9519",a),n(a)}}(e,n)}))}function ae(e){var n=e.match(/^(\d+:[0-5][0-9]:[0-5][0-9])(\.[0-9]{1,3})?$/);if(n&&n[2]){for(var t=n[2];t.length<4;)t+="0";return n[1]+t}return n&&n[1]?n[1]:"00:00:00"}function re(e){var n="WEBVTT\n\n"+e.map((function(e,n){return"".concat(n+1,"\n").concat(e.startTime," --\x3e ").concat(e.endTime,"\n").concat(e.content,"\n")})).join("\n");return T.clog(n),n}function oe(e,n){var t=document.createElement("a");t.style.display="none",t.href=e,t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function ie(e){return e&&0!==e.length?ee(re(e)):""}function le(){return(le=Object(x.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te();case 3:if((n=e.sent)&&0!==n.length){e.next=6;break}return e.abrupt("return",!1);case 6:return oe(ie(n),"\u5b57\u5e55.vtt"),e.abrupt("return",!0);case 11:throw e.prev=11,e.t0=e.catch(0),T.clog("\u4e0b\u8f7d\u5b57\u5e55\u51fa\u9519\uff1a",e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var ce={readSubFileAsText:function(e){return K.apply(this,arguments)},createSubArray:function(e){return X.apply(this,arguments)},createVttSubBlobUrl:ee,mapSubToFullModel:ne,saveSubArray:function(e){return new Promise((function(n,t){return function(e,n,t){try{var a=t.map((function(e){return ne(e)})),r=JSON.stringify(a);localStorage.setItem(G,r),e(r)}catch(o){T.clog("subs\u5b58\u5165local\u65f6\u51fa\u9519",o),n(o)}}(n,t,e)}))},cleanSubArray:function(){localStorage.removeItem(G)},getSubArray:te,getSubLength:function(e){var n={startTime:$.schema.startTime,endTime:$.schema.endTime};return $.validate(e,n,{abortEarly:!0})?e.length:Y(ae(e.startTime),ae(e.endTime))},mapSubArray2Text:re,createSubArrayUrl:ie,downloadFromUrl:oe,downloadSubFile:function(){return le.apply(this,arguments)},getDefaultSub:function(e,n){T.clog("\u63d2\u5165\u53c2\u6570\uff1a",e,n,typeof(e+n));var t=0,a=.001;if("number"===typeof(e+n))return t=Number(e.toFixed(3)),a=Number(n.toFixed(3)),new C(t,a,"\u9ed8\u8ba4\u6587\u672c");var r=$.validateTime(e),o=$.validateTime(n);return r||o||(t=J(ae(e)),a=J(ae(n))),new C(t,a,"\u9ed8\u8ba4\u6587\u672c")},toTime:function(e){return N.number2Time(e)},toNumber:J,getTimeLength:Y,createSubUrlWorker:function(e){var n=new Blob(['this.addEventListener(\'message\', function (e) {\n    //\u8f6c\u4e3a\u6587\u672c\n    // subArray\u7684\u683c\u5f0f\u5fc5\u987b\u7b26\u5408\u5b58\u50a8\u89c4\u8303\n    const subArray = e.data;\n    const vttCueStrArray = subArray.map(\n    (sub, index) =>\n      `${index + 1}\n${sub.startTime} --\x3e ${sub.endTime}\n${sub.content}\n`\n  );\n    const vttText = "WEBVTT\\n\\n" + vttCueStrArray.join("\\n");\n    const vttBlob = new Blob([vttText], {\n      type: "text/vtt"\n    });\n    const subUrl = URL.createObjectURL(vttBlob);\n    this.postMessage(subUrl);\n  }, false);']),t=new Worker(URL.createObjectURL(n));return t.onmessage=function(n){var t=n.data;e(t)},t},sortSubArray:function(e){var n=Object(g.a)(e);return n.sort((function(e,n){return e.start-n.start})),n}},se=function(e){var n=e.head,t=e.small,a=e.dataArray,o=e.type;return r.a.createElement("div",{className:"toast show",role:"alert","aria-live":"assertive","aria-atomic":"true",style:{border:"none",boxShadow:"none"}},r.a.createElement("div",{className:"toast-header"},r.a.createElement("svg",{className:"rounded mr-2",width:"15",height:"15",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid slice",focusable:"false",role:"img"},r.a.createElement("rect",{width:"100%",height:"100%",fill:{primary:"#007aff",warning:"#ff8300"}[o]})),r.a.createElement("strong",{className:"mr-auto"},n),r.a.createElement("small",null,t||"\u63d0\u793a")),r.a.createElement("div",{className:"toast-body"},r.a.createElement("ul",{className:"list-group list-group-flush"},a.map((function(e){return r.a.createElement("li",{className:"list-group-item",key:e},e)})))))},ue={slide:b.c,zoom:b.e,flip:b.b,bounce:b.a};function de(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top_left",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"DEFAULT",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bounce",o=(n+"").toUpperCase(),i=(t+"").toUpperCase(),l=Object(h.a)({position:b.f.POSITION[o],type:b.f.TYPE[i],transition:ue[r]},a);return Object(b.f)(e,l)}var me={notify:de,bootstrapToast:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top_left",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"zoom";return de(r.a.createElement(se,{head:"\u8bf7\u68c0\u67e5\u8f93\u5165\u683c\u5f0f",dataArray:e,type:n}),t,"default",a,o)},isActive:function(e){return b.f.isActive(e)},done:function(e){return b.f.done(e)}},pe={home:"".concat(window.location.protocol,"//").concat(window.location.host,"/"),subEditorPath:"/",trackTest:"/test"};var be={createVideoType:function(e){if("string"!==typeof e)return"";var n=e.match(/^video\/(mp4|x-(flv))+$/);T.clog("\u5339\u914d\u89c6\u9891\u7c7b\u578b",n);var t=n&&n[2]?n[2]+"Custom":n?n[1]:"";return T.clog("\u5339\u914d\u548c\u62fc\u63a5\u7684\u7ed3\u679c",t),t},getDefaultPicUrl:function(){return"".concat(pe.home,"subEditor.png")}},fe=t(45),he=t.n(fe);he.a.configure({minimum:.1});var ge={start:function(e){return e?he.a.start().set(e):he.a.start()},set:function(e){return e&&he.a.set(e)},inc:function(e){return e&&he.a.inc(e)},done:function(){he.a.done()}},ve=t(121);function ye(){var e=Object(w.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  cursor: pointer;\n"]);return ye=function(){return e},e}function xe(){var e=Object(w.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 30px;\n  // height: 100%;\n  cursor: pointer;\n  overflow: hidden;\n  color: #ccc;\n  background: #ec6464;\n  border-style: none;\n  border-radius: 20px;\n  padding: 9px 16px;\n  margin-right: 10px;\n  // outline: none;\n  transition: all 300ms linear 0s;\n\n  span {\n    display: none;\n  }\n\n  &:hover {\n    color: #ec6464;\n    background-color: #e1e1e1;\n    height: 40px;\n    span {\n      display: block;\n    }\n    i {\n      display: none;\n    }\n  }\n\n  i {\n    margin-right: 0px;\n  }\n"]);return xe=function(){return e},e}function we(){var e=Object(w.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 30px;\n  // height: 100%;\n  cursor: pointer;\n  overflow: hidden;\n  color: #ccc;\n  background: #529393;\n  border-style: none;\n  border-radius: 20px;\n  padding: 9px 16px;\n  margin-right: 10px;\n  // outline: none;\n  transition: all 300ms linear 0s;\n\n  span {\n    display: none;\n  }\n\n  &:hover {\n    color: #fff;\n    background-color: #43d7d7;\n    height: 40px;\n    span {\n      display: block;\n    }\n    i {\n      display: none;\n    }\n  }\n\n  i {\n    margin-right: 0px;\n  }\n"]);return we=function(){return e},e}function Se(){var e=Object(w.a)(["\n  text-decoration: none;\n  font-size: 22px;\n  font-style: italic;\n  font-weight: 400;\n  color: #66cccc;\n\n  :hover {\n    text-decoration: none;\n    color: #66cccc;\n  }\n\n  .version {\n    font-size: 12px;\n    font-weight: 600;\n    margin-left: 20px;\n    opacity: 0.4;\n    font-style: italic;\n    color: #262a3e;\n  }\n"]);return Se=function(){return e},e}function Ee(){var e=Object(w.a)(["\n  //\u5bfc\u822a\u680f\u56fa\u5b9a50px\n  height: 50px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background-color: hsla(0, 0%, 100%, 0.8);\n  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);\n\n  .band {\n    display: flex;\n    align-items: center;\n    height: 100%;\n    padding-left: 30px;\n    flex-grow: 6;\n  }\n\n  .body {\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    flex-grow: 1;\n\n    .buttons {\n      height: 100%;\n      display: flex;\n      align-items: center;\n    }\n\n    .links {\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: space-around;\n\n      margin-right: 40px;\n      i {\n        margin-right: 5px;\n      }\n      a {\n        color: #4c7b7b;\n        text-decoration: none;\n        font-size: 18px;\n        font-weight: 600;\n        padding: 0 10px 0 10px;\n\n        &:hover {\n          color: #66cccc;\n          //   text-decoration: underline;\n        }\n      }\n\n      .avatar {\n        border-radius: 50%;\n        height: 40px;\n        border: 1px solid #ddd;\n        padding: 4px;\n        display: block;\n      }\n    }\n  }\n"]);return Ee=function(){return e},e}var ke=S.b.header(Ee()),Te=S.b.a(Se()),Ce=S.b.div(we()),Oe=S.b.div(xe()),je=S.b.input(ye()),Ne=function(e){function n(){var e,t;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(t=Object(u.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(o)))).handleSubFile=function(){var e=Object(x.a)(y.a.mark((function e(n){var a,o,i,l,c,s,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge.start(),a=n.currentTarget.files[0],o=t.props,i=o.updateSubArray,l=o.updateSubUrl,e.prev=3,e.next=6,ce.readSubFileAsText(a);case 6:return c=e.sent,me.notify(r.a.createElement("p",null,c),"top_center","default",{autoClose:!1,className:"textReader"}),s=ce.createVttSubBlobUrl(c),l(s,!0),e.next=12,ce.createSubArray(s);case 12:u=e.sent,i(u,!0),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),me.notify("<Header>".concat(e.t0.message),"top_center","warning");case 19:ge.done();case 20:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(n){return e.apply(this,arguments)}}(),t.handleVideoFile=function(e){ge.start();var n=e.currentTarget.files[0],a=document.createElement("video");T.clog("\u521b\u5efa\u5143\u7d20\uff1a",a,a.canPlayType(n.type));var r=URL.createObjectURL(n);T.clog("\u89c6\u9891url",r),(0,t.props.onSwitch)(n.type,r),ge.done()},t.handleSubFileDownload=function(){(0,t.props.onDownload)()},t.handleSubClean=function(){(0,t.props.onClean)()},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(ke,null,r.a.createElement("div",{className:"band"},r.a.createElement(Te,{href:pe.subEditorPath,title:"Copyright \xa9 2020 SH"},"SubEditor",r.a.createElement("span",{className:"version"},"version ",ve.version))),r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"buttons"},r.a.createElement(Ce,null,r.a.createElement("i",{className:"fa fa-folder-open","aria-hidden":"true"}),r.a.createElement(je,{className:"uploadSubtitle",type:"file",name:"file",onChange:this.handleSubFile}),r.a.createElement("span",null,"\u6253\u5f00\u5b57\u5e55")),r.a.createElement(Ce,null,r.a.createElement("i",{className:"fa fa-play-circle","aria-hidden":"true"}),r.a.createElement(je,{className:"uploadVideo",type:"file",name:"file",onChange:this.handleVideoFile}),r.a.createElement("span",null,"\u6253\u5f00\u89c6\u9891")),r.a.createElement(Ce,{onClick:this.handleSubFileDownload},r.a.createElement("i",{className:"fa fa-cloud-download","aria-hidden":"true"}),r.a.createElement("span",null,"\u4e0b\u8f7d\u5b57\u5e55")),r.a.createElement(Oe,{onClick:this.handleSubClean},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"}),r.a.createElement("span",null,"\u6e05\u7a7a\u5b57\u5e55"))),r.a.createElement("div",{className:"links"},r.a.createElement("a",{href:"https://github.com/Shirtiny/SubEditor",title:"\u524d\u5f80Github"},r.a.createElement("i",{className:"fa fa-github","aria-hidden":"true"}),"Github"),r.a.createElement("a",{href:"http://bbs.vcb-s.com/",title:"\u7528\u6237"},r.a.createElement("img",{className:"avatar",alt:"avatar",src:"http://bbs.vcb-s.com/data/attachment/common/d6/common_39_icon.png"})))))}}]),n}(a.PureComponent),Ae=t(124),Ie=t.n(Ae),_e=t(94);function Re(){var e=Object(w.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 70%;\n  padding: 15px;\n  // border-bottom: 1px solid rgb(10, 10, 10);\n  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);\n\n  .dplayer_DefaultSize {\n    width: 90%;\n    height: 90%;\n  }\n\n  .dplayer {\n    max-width: 100%;\n    max-height: 100%;\n  }\n\n  .dplayer_disable {\n    pointer-events: none;\n  }\n\n  .playerBorder {\n    border: 4px solid #529393;\n    border-radius: 0.5em;\n    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);\n  }\n\n  .hiddenSubs {\n    ::cue {\n      opacity: 0;\n    }\n  }\n"]);return Re=function(){return e},e}var Be=S.b.div(Re()),Ue=function(e){function n(){var e,t;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(r)))).load=function(e){(0,t.props.initPlayer)(e)},t.error=function(){document.getElementById("player").classList.add("dplayer_DefaultSize","dplayer_disable")},t.canPlay=function(){var e=t.props,n=e.player,a=e.onVideoCanPlay;n.notice("\u221a",1500,.8),a(),document.getElementById("player").classList.remove("dplayer_disable")},t.playing=function(){(0,t.props.onVideoPlaying)()},t.fullscreen=function(){var e=document.getElementById("player");e.classList.remove("playerBorder"),e.style.resize=""},t.fullscreenCancel=function(){var e=document.getElementById("player");e.classList.add("playerBorder"),e.style.resize="both"},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,n){return!1}},{key:"render",value:function(){var e=this.props,n=e.videoUrl,t=e.picUrl,a=e.subUrl;return r.a.createElement(Be,{id:"playerBox"},r.a.createElement(Ie.a,{id:"player",className:"playerBorder dplayer_disable "+(t?"":"dplayer_DefaultSize"),style:{resize:"both"},options:{video:{url:n,pic:t,customType:{flvCustom:function(e,n){if(T.clog("\u652f\u6301flv"),_e.a.isSupported()){var t=_e.a.createPlayer({type:"flv",url:e.src,hasAudio:!0});t.attachMediaElement(e),t.load()}}}},subtitle:{url:a,type:"webvtt",fontSize:"25px",bottom:"3%",color:"rgb(37, 211, 211)"},contextmenu:[{text:"SubEditor"},{text:"\u4f7f\u5185\u5bb9\u7684\u9ad8\u5ea6\u9002\u5e94\u4e8e\u5bbd\u5ea6",click:function(e){document.getElementById("player").style.height=""}},{text:"\u9ed8\u8ba4\u5bbd\u5ea6\u548c\u9ad8\u5ea6",click:function(e){var n=document.getElementById("player");n.style.height="",n.style.width="90%"}},{text:"chrome\u5b57\u5e55\u9690\u85cf/\u663e\u793a",click:function(e){var n=e.video;n.className.indexOf("hiddenSubs")>0?n.classList.remove("hiddenSubs"):n.classList.add("hiddenSubs")}}],theme:"#ccc",loop:!0},onLoad:this.load,onError:this.error,onCanplay:this.canPlay,onPlaying:this.playing,onFullscreen:this.fullscreen,onFullscreenCancel:this.fullscreenCancel}))}}]),n}(a.Component),Pe=t(131);function Fe(){var e=Object(w.a)(["\n  font-size: 14px;\n  color: #495057;\n  background-color: #fff;\n  border: 1px solid #ced4da;\n  border-radius: 0.25rem;\n  background-clip: padding-box;\n\n  height: calc(1.5em + 0.5rem + 2px);\n  padding: 0.25rem 0.25rem;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  border-radius: 0.2rem;\n\n  &.input_success {\n    :focus {\n      border-color: #28a745;\n      box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);\n    }\n  }\n  &.input_error {\n    border-color: #dc3545;\n    :focus {\n      border-color: #28a745;\n      box-shadow: 0 0 0 0.2rem rgba(232, 43, 43, 0.3);\n    }\n  }\n"]);return Fe=function(){return e},e}var ze=S.b.input(Fe()),Le=function(e){var n=e.className,t=e.type,a=e.name,o=e.value,i=e.onChange,l=e.disabled,c=e.style,s=e.errors;return r.a.createElement(ze,{disabled:l,className:[].concat(Object(g.a)(n),[s[a]?"input_error":"input_success"]),type:t,value:o,onChange:function(e){return i(a,e.currentTarget.value)},style:Object(h.a)({},c)})};function De(){var e=Object(w.a)(["\n  .rowClasses {\n    background-color: #f2f2f2;\n    // border-bottom: 1px solid rgb(36, 41, 45);\n    min-width: 650px;\n    transition: all 0.15s ease;\n\n    //\u53d6\u6d88\u6d4f\u89c8\u5668\u7684\u53cc\u51fb\u9009\u4e2d\n    -moz-user-select: none; /*\u706b\u72d0*/\n    -webkit-user-select: none; /*webkit\u6d4f\u89c8\u5668*/\n    -ms-user-select: none; /*IE10*/\n    -khtml-user-select: none; /*\u65e9\u671f\u6d4f\u89c8\u5668*/\n    user-select: none;\n\n    &.odd {\n      background-color: #fff;\n    }\n\n    &.highlight {\n      background-color: #2196f3;\n      text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);\n    }\n\n    &.illegal {\n      background-color: #c75123;\n      text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);\n    }\n\n    .rowT {\n      padding: 10px 5px;\n      text-align: center;\n    }\n\n    &: hover {\n      background-color: #529393;\n      color: #fff;\n      //\u5b57\u7a0d\u5fae\u5927\u4e9b\n      font-size: 14px;\n    }\n\n    &.onEditing {\n      background-color: #66cccc;\n\n      //\u7f16\u8f91\u65f6\u8fd4\u56de\u9690\u85cf \u975e\u7f16\u8f91\u72b6\u6001\u8fd4\u56de\u663e\u793a\n      .display_onEditing {\n        display: block !important;\n      }\n      .hidden_onEditing {\n        display: none !important;\n      }\n    }\n\n    .editing_default_hidden {\n      //\u9ed8\u8ba4\u9690\u85cf\n      display: none;\n      width: 100%;\n      height: 100%;\n    }\n\n    .operation {\n      display: flex;\n      justify-content: center;\n\n      i {\n        width: 25px;\n        cursor: pointer;\n        font-size: 16px;\n        &: hover {\n          //\u56fe\u6807\u7c97\u4e9b\n          font-weight: 600;\n          // color: #ccc;\n          color: #82a8b7;\n          &.deleteIcon {\n            color: #f5f239;\n          }\n        }\n      }\n    }\n  }\n\n  .lineBox {\n    display: none;\n    height: 0;\n    width: 100%;\n    position: absolute;\n    left: 0;\n    bottom: 0px;\n    border-bottom: 0px dashed #529393;\n    box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    transition: color, border-color 0.3s ease-in-out;\n    &:hover {\n      display: block;\n      bottom: -5px;\n      border-bottom: 10px solid #02c0ff;\n      .insertBtn {\n        color: #02c0ff !important;\n        bottom: 10px;\n      }\n    }\n  }\n\n  .insertBtn {\n    position: absolute;\n    right: 4px;\n    width: 20px;\n    height: 20px;\n    bottom: 15px;\n  }\n\n  //\u5f53scroll\u6eda\u5230\u5f53\u524drow row\u7684\u52a8\u753b\n  .scrollToRowAnimation {\n    animation: scrollToRowAnimation 3s;\n    //\u64ad\u653e\u6b21\u6570\u65e0\u9650\u5236\n    // animation-iteration-count: infinite;\n  }\n\n  .scrollIndexBackColor {\n    transition: background-color 0.5s ease-in;\n    background-color: #04e8e8 !important;\n    &:hover {\n      color: black;\n    }\n  }\n"]);return De=function(){return e},e}var We=S.b.div(De()),Me=0,Ve=function(e){var n=e.index,t=e.style,a=e.className,o=e.rowData,i=e.onRowRemove,l=e.onRowEdit,c=e.onRowClick,s=e.onRowCommit,u=e.onRowCancel,d=e.onRowInsert,m=e.editingSub,p=e.errors,b=e.onInputValueChange,f=e.displayIndex,h=e.scrollIndex,g=["editing_default_hidden","display_onEditing"].join(" ");return r.a.createElement(We,null,r.a.createElement("div",{key:n,style:t,className:[a,"rowClasses",n%2?"odd":"",o.editing?"onEditing":"",h===n?"scrollIndexBackColor":""].join(" "),onClick:function(){Me+=1,setTimeout((function(){1===Me?c(o):2===Me&&l(o),Me=0}),200)}},r.a.createElement("div",{className:"rowT operation",style:{width:90}},r.a.createElement("i",{onClick:function(e){e.stopPropagation(),l(o)},className:"fa fa-pencil ".concat("hidden_onEditing"),title:"\u7f16\u8f91"}),r.a.createElement("i",{onClick:function(e){e.stopPropagation(),s(o)},className:"fa fa-check-circle-o ".concat(g),title:"\u4fdd\u5b58"}),r.a.createElement("i",{className:"fa fa-times deleteIcon",onClick:function(e){e.stopPropagation(),i(o)},title:"\u5220\u9664"})),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"".concat("hidden_onEditing")},o.startTime),r.a.createElement(Le,{className:[g],type:"text",name:"startTime",value:m.startTime,onChange:b,errors:p})),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"".concat("hidden_onEditing")},o.endTime),r.a.createElement(Le,{className:[g],type:"text",name:"endTime",value:m.endTime,onChange:b,errors:p})),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"".concat("hidden_onEditing")},o.length),r.a.createElement("span",{className:"".concat(g)},m.length)),r.a.createElement("div",{className:"rowT",style:{flex:1}},r.a.createElement("span",{className:"".concat("hidden_onEditing")},o.content),r.a.createElement(Le,{className:[g],type:"text",name:"content",value:m.content,onChange:b,errors:p})),r.a.createElement("div",{className:"rowT operation",style:{width:50}},r.a.createElement("span",{style:{display:f?"block":"none"},className:"".concat("hidden_onEditing")},n),r.a.createElement("i",{onClick:function(e){e.stopPropagation(),u(o)},className:"fa fa-reply ".concat(g),title:"\u53d6\u6d88\u7f16\u8f91"}),r.a.createElement("div",{className:"".concat("hidden_onEditing"," lineBox "),style:{display:f?"none":"block"}},r.a.createElement("i",{className:"fa fa-plus-square  insertBtn",title:"\u63d2\u5165\u5b57\u5e55",onClick:function(e){e.stopPropagation(),d(o)}})))))};function He(){var e=Object(w.a)(["\n  background: #c0d9d9;\n  display: flex;\n  min-width: 650px;\n\n  .rowT {\n    padding: 10px 5px;\n    font-style: normal;\n    font-weight: normal;\n    font-size: 14px;\n    text-align: center;\n    text-transform: none;\n  }\n\n  .buttonLike {\n    position: relative;\n    background: #ffffff;\n    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.25);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 30px;\n    // margin-right: 10px;\n    padding: 9px 16px;\n    border-style: none;\n    border-radius: 10px;\n    overflow: hidden;\n    transition: all 200ms linear 0s;\n\n    i {\n      margin-right: 5px;\n    }\n  }\n\n  .switchButton {\n    cursor: pointer;\n    &:hover {\n      color: #fff;\n      background-color: #43d7d7;\n      span {\n        display: block;\n      }\n    }\n  }\n\n  .stayButton {\n    height: 100%;\n    width: 100%;\n    position: absolute;\n    left: 0;\n    top: 0px;\n    cursor: pointer;\n    span {\n      position: relative;\n      top: 4px;\n    }\n    transition: all 0.3s ease;\n    &:hover {\n      color: #fff;\n      background-color: #43d7d7;\n    }\n  }\n"]);return He=function(){return e},e}var qe=S.b.div(He()),$e=function(e){var n=e.displayIndex,t=e.onDisplayIndexSwitch,a=e.subArrayLenIsZero,o=e.onInsert;return r.a.createElement(qe,null,r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("div",{className:"buttonLike"},r.a.createElement("span",{style:{display:a?"none":"block"}},r.a.createElement("i",{className:"fa fa-pencil-square-o","aria-hidden":"true"}),"\u7f16\u8f91"),r.a.createElement("div",{onClick:function(){return o()},className:"stayButton",style:{display:a?"block":"none"}},r.a.createElement("span",null,r.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}),"\u65b0\u5efa")))),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"buttonLike"},r.a.createElement("i",{className:"fa fa-step-backward","aria-hidden":"true"}),"\u5f00\u59cb")),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"buttonLike"},r.a.createElement("i",{className:"fa fa-step-forward","aria-hidden":"true"}),"\u7ed3\u675f")),r.a.createElement("div",{className:"rowT",style:{width:100}},r.a.createElement("span",{className:"buttonLike"},r.a.createElement("i",{className:"fa fa-spinner fa-spin","aria-hidden":"true"}),"\u65f6\u957f")),r.a.createElement("div",{className:"rowT",style:{flex:1}},r.a.createElement("span",{className:"buttonLike "},r.a.createElement("i",{className:"fa fa-text-width","aria-hidden":"true"}),"\u5185\u5bb9")),r.a.createElement("div",{className:"rowT",style:{width:50}},r.a.createElement("div",{className:"buttonLike switchButton",onClick:function(){return t(!n)}},r.a.createElement("span",{style:{display:n?"block":"none"},className:" fa fa-sort-amount-asc",title:"\u5207\u6362\u5230\u529f\u80fd"}),r.a.createElement("span",{style:{display:n?"none":"block"},className:" fa fa-sliders",title:"\u5207\u6362\u5230\u5e8f\u53f7"}))))};function Ge(){var e=Object(w.a)(["\n  .ReactVirtualized__Table {\n    font-size: 12px;\n    background: #e3eeee;\n    // background: #c0d9d9; root\u80cc\u666f\u8272\n\n    .ReactVirtualized__Table__Grid {\n      outline: none;\n      box-shadow: 0 1px 5px rgba(0, 0, 0, 0.25);\n      border-radius: 0.5rem;\n      min-width: 650px;\n\n      .ReactVirtualized__Grid__innerScrollContainer {\n        min-width: 650px;\n      }\n    }\n\n    .gridScrollWrap {\n      overflow: hidden !important;\n      :hover {\n        overflow-y: scroll !important;\n\n        // fireFox\n        scrollbar-color: #6fd1d8 #fff;\n        // scrollbar-color: light;\n        scrollbar-width: thin;\n        // scrollbar-width: none;\n\n        //Safari and Chrome\n        ::-webkit-scrollbar {\n          // display: none;\n          width: 5px; /*\u9ad8\u5bbd\u5206\u522b\u5bf9\u5e94\u6a2a\u7ad6\u6eda\u52a8\u6761\u7684\u5c3a\u5bf8*/\n        }\n        ::-webkit-scrollbar-thumb {\n          /*\u6eda\u52a8\u6761\u91cc\u9762\u5c0f\u65b9\u5757*/\n          border-radius: 10px;\n          box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n          background: #6fd1d8;\n          height: 10px;\n        }\n\n        ::-webkit-scrollbar-track {\n          /*\u6eda\u52a8\u6761\u91cc\u9762\u8f68\u9053*/\n          box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n          border-radius: 10px;\n          background: #fff;\n        }\n      }\n    }\n\n    .input,\n    .textarea {\n      border: none;\n      padding: 5px;\n      min-height: 30px;\n      font-size: 12px;\n      text-align: center;\n      background-color: #3a3a3a;\n    }\n\n    .textarea {\n      resize: vertical;\n    }\n\n    p {\n      line-height: 1.5;\n      margin: 0;\n    }\n  }\n"]);return Ge=function(){return e},e}var Je=S.b.div(Ge()),Ye=function(e){function n(){var e,t;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(t=Object(u.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(o)))).$tableRef=r.a.createRef(),t.state={editingSub:{start:0,startTime:"",end:0,endTime:"",length:0,content:""},errors:{},displayIndex:!0},t.schema={},t.errorSchema={},t.toastId_validate=null,t.toastId_validatePropertys={startTime:null,endTime:null,content:null},t.validate=function(){var e=$.validate(t.state.editingSub,t.schema),n={};return e&&e.map((function(e){return n[e]=t.errorSchema[e]})),0===Object.keys(n).length?(t.setState({errors:{}}),!1):(t.setState({errors:n}),n)},t.toast_validate=function(e){me.done(t.toastId_validate),t.toastId_validate=me.bootstrapToast(e,"warning","top_left",{autoClose:1e4},"flip")},t.validateProperty=function(e,n){var a=Object(A.a)({},e,t.schema[e]),r=$.validateProperty(e,n,a),o=Object(h.a)({},t.state.errors);return r?(o[e]=t.errorSchema[e],t.setState({errors:o}),Object(A.a)({},e,t.errorSchema[e])):(delete o[e],t.setState({errors:o}),!1)},t.toast_validateProperty=function(e,n){var a=t.toastId_validatePropertys[e],r=Object.values(t.toastId_validatePropertys),o=r.indexOf(a);r.splice(o,1),r.map((function(e){return me.done(e)})),me.isActive(a)||(t.toastId_validatePropertys[e]=me.notify(n.length>0&&n[0],"bottom_left","default",{hideProgressBar:!0,autoClose:5e3},"flip"))},t.handleInputValue=function(e,n){var a=Object(h.a)({},t.state.editingSub);a[e]=n;var r=t.validateProperty(e,n);if(r){var o=$.errors2messages(r);t.toast_validateProperty(e,o)}else me.done(t.toastId_validatePropertys[e]),a.length=ce.getSubLength(a);t.setState({editingSub:a},(function(){}))},t.handleRowEdit=function(e){var n=t.props.onEdit,a=ce.mapSubToFullModel(e);t.setState({editingSub:a},(function(){t.validate(),T.clog("\u8868\u5355\u56de\u663e\uff1a",t.state.editingSub)})),n(e)},t.handleRowClick=function(e){(0,t.props.onClick)(e)},t.handleRowCommit=function(e){var n=t.props.onCommit,a=t.validate();if(a){var r=$.errors2messages(a);t.toast_validate(r)}else me.done(t.toast_validate),n(e,ce.mapSubToFullModel(t.state.editingSub))},t.handleRowRemove=function(e){var n=t.props.onRemove;T.clog("\u5220\u9664\u4e00\u884c\uff1a",e),n(e)},t.handleRowCancel=function(e){var n=t.props.onCancel;T.clog("\u53d6\u6d88\u7f16\u8f91\uff1a",e),n(e)},t.tableBackGroundColor=function(e){var n=e&&0===e.length?"#e3eeee":"#c0d9d9",t=document.getElementById("vSubTable");t&&(t.style.backgroundColor=n)},t.handleDisplayIndexSwitch=function(e){var n=!!e;t.setState({displayIndex:n})},t.handleRowInsert=function(e){(0,t.props.onInsert)(e)},t.scrollToButtom=function(){var e=document.getElementsByClassName("gridScrollWrap")[0],n=e.scrollTop,t=e.scrollHeight,a=e.clientHeight;console.log(e,"scrollHeight:",t,";scrollTop:",n,";clientHeight:",a,";scrollHeight - scrollTop - clientHeight:",t-n-a),e.scrollTop=e.scrollTop+(t-n-a)},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"componentDidMount",value:function(){this.schema=$.getEditingSubSchema(),this.errorSchema=$.getEditingErrorSchema()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this,n=this.props,t=n.subArray,a=n.scrollIndex,o=n.container,i=n.onInsert,l=o.containerHeight,c=o.containerWidth;return this.tableBackGroundColor(t),r.a.createElement(Je,null,r.a.createElement(Pe.a,{id:"vSubTable",ref:this.$tableRef,headerHeight:35,width:c/2,height:l,gridClassName:"gridScrollWrap",rowHeight:60,scrollToIndex:a,rowCount:t.length,rowGetter:function(e){var n=e.index;return t[n]},headerRowRenderer:function(){return r.a.createElement($e,Object.assign({},e.state,{subArrayLenIsZero:t&&0===t.length,onInsert:i,onDisplayIndexSwitch:e.handleDisplayIndexSwitch}))},rowRenderer:function(n){return r.a.createElement(Ve,Object.assign({},n,{onRowRemove:e.handleRowRemove,onRowEdit:e.handleRowEdit,onRowClick:e.handleRowClick,onRowCommit:e.handleRowCommit,onRowCancel:e.handleRowCancel,onRowInsert:e.handleRowInsert,onInputValueChange:e.handleInputValue},e.state,{scrollIndex:a}))}}))}}]),n}(a.PureComponent);function Ze(){var e=Object(w.a)(['\n  flex: 1;\n  display: flex;\n  padding: 15px;\n  .clearBox {\n    flex: 1;\n    display: flex;\n    flex-direction: column-reverse;\n  }\n  .toolsBox {\n    flex: 1;\n    // border: 1px solid;\n  }\n\n  //\u6ed1\u5757\u6837\u5f0f\n  input[type="range"] {\n    appearance: none;\n    height: 3px;\n    width: 200px;\n    outline: none;\n    background-color: #529393;\n    border-radius: 10px;\n  }\n\n  //chorme\n  input[type="range"]::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    height: 15px;\n    width: 15px;\n    background: #ffffff;\n    border-radius: 50%;\n  }\n']);return Ze=function(){return e},e}var Ke=S.b.div(Ze()),Qe=r.a.memo((function(e){var n=e.duration,t=e.onDurationChange;return r.a.createElement(Ke,null,r.a.createElement("div",{className:"clearBox"},r.a.createElement("input",{type:"range",title:n,value:n,min:"10",max:"20",step:"1",onChange:function(e){t(Number(e.currentTarget.value))}})))})),Xe=t(129);function en(){var e=Object(w.a)(["\n  //\u5e95\u90e8\u65f6\u95f4\u8f74 \u56fa\u5b9a150px\n  height: 150px;\n  position: relative;\n  display: flex;\n  width: 100%;\n  background-color: #c0d9d9;\n  // border-top: 1px solid rgb(10, 10, 10);\n  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.3);\n"]);return en=function(){return e},e}var nn=S.b.div(en()),tn=function(e){var n=e.currentTime,t=e.videoUrl,a=e.onWaveClick,o=e.onWaveContextmenu,i=e.subArray,l=e.onSubBlockMove,c=e.onSubBlockMoveError,s=e.onSubBlockResize,u=e.onSubBlockClick,d=e.duration;return r.a.createElement(nn,null,r.a.createElement(Xe.ShWave,{duration:d,backgroundColor:"#529393",currentTime:n,throttleWait:1,url:t,waveColor:"#fbf8f86b",alterWaveColor:"#57e3e3",waveScale:.8,click:a,contextmenu:o,subArray:i,onSubMove:l,onSubMoveError:c,ErrorThrottleWait:1200,onSubResize:s,onSubClick:u}))};function an(){var e=Object(w.a)(["\n  flex: 1;\n  margin-top: 5px;\n"]);return an=function(){return e},e}function rn(){var e=Object(w.a)(["\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n"]);return rn=function(){return e},e}function on(){var e=Object(w.a)(["\n  position: relative;\n  display: flex;\n  flex: 1;\n"]);return on=function(){return e},e}function ln(){var e=Object(w.a)(["\n    html,\n    body,\n    #root {\n        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;\n        line-height: 1.5;\n        height: 100%;\n        overflow: hidden;\n    }\n\n    *, *::before, *::after {\n        box-sizing: border-box;\n    }\n\n    #root {\n        display: flex;\n        flex-direction: column;\n        font-size: 14px;\n        // color: #ccc; \u767d\u5b57\n        background: #C0D9D9;\n        // background: #66CCCC;\n    }\n\n    #nprogress .bar {\n        top: 50px !important;\n\n        .peg {\n            display: none !important;\n        }\n    }\n\n    ::-webkit-scrollbar {\n        width: 10px;\n    }\n    \n    ::-webkit-scrollbar-thumb {\n        background-color: #666;\n    }\n    \n    ::-webkit-scrollbar-thumb:hover {\n        background-color: #ccc;\n    }\n"]);return ln=function(){return e},e}var cn=Object(S.a)(ln()),sn=S.b.div(on()),un=S.b.div(rn()),dn=S.b.div(an()),mn=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,pn=function(e){function n(){var e,t;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(t=Object(u.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(o)))).state={videoUrl:"",subUrl:"",subArray:[],picUrl:be.getDefaultPicUrl(),container:{containerHeight:10,containerWidth:10},scrollIndex:-1,player:null,currentTime:0,duration:15},t.subUrlWorker=null,t.resizeContainer=function(){var e=document.body.clientHeight-200,n=document.body.clientWidth;T.clog("\u66f4\u65b0container\u7684\u5bbd\u9ad8",n,e),t.setState({container:{containerHeight:e,containerWidth:n}})},t.addResizeListener=function(){var e=function(e,n){var t;return function(){clearTimeout(t),t=setTimeout(e,n)}}(t.resizeContainer,300);window.addEventListener("resize",e),T.clog("\u6dfb\u52a0resize\u4e8b\u4ef6\u76d1\u542c")},t.updateOneState=function(e){t.setState(e),T.clog("\u66f4\u65b0state\uff1a",e)},t.updateSubArray=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.map((function(e){return ce.mapSubToFullModel(e)}));var a=ce.sortSubArray(e);t.setState({scrollIndex:-1}),t.setState({subArray:a},(function(){n&&(t.storageSubs(t.state.subArray),t.subUrlWorker.postMessage(t.state.subArray))}))},t.updateSubUrl=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];URL.revokeObjectURL(t.state.subUrl),T.clog("\u91ca\u653e\uff1a",t.state.subUrl),t.setState({subUrl:e},(function(){n&&(T.clog("\u88c5\u8f7d\uff1a",t.state.subUrl),t.loadTrack(t.state.subUrl))}))},t.loadTrack=function(e){if(t.cleanSubP(),t.state.player&&t.state.player.video){var n=t.state.player.video.firstElementChild;n.default=!0,n.kind="subtitles",n.src=e}},t.cleanSubP=function(){var e=document.getElementsByClassName("dplayer-subtitle")[0],n=e.firstChild;n&&(e.removeChild(n),T.clog("\u6e05\u9664\u5b57\u5e55\u6b8b\u7559",n))},t.storageSubs=function(e){ce.saveSubArray(e)},t.cleanStorageSubs=function(){ce.cleanSubArray(),T.clog("\u6e05\u7a7a\u5b58\u50a8\u7684\u5b57\u5e55")},t.initSubTable=Object(x.a)(y.a.mark((function e(){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce.getSubArray();case 3:n=e.sent,T.clog("\u4ece\u5b58\u50a8\u4e2d\uff0c\u521d\u59cb\u5316\u5b57\u5e55",n),t.updateSubArray(n),a=ce.createSubArrayUrl(n),t.updateSubUrl(a,!0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),me.notify("\u8bfb\u53d6\u5b57\u5e55\u5931\u8d25\uff0c\u8bf7\u5c1d\u8bd5\u6e05\u9664\u7f13\u5b58","top_center","info");case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),t.handleSubRemove=function(e){var n=Object(g.a)(t.state.subArray),a=n.indexOf(e);n.splice(a,1),t.updateSubArray(n,!0),T.clog("\u5220\u9664",e,a)},t.handleSubEdit=function(e){var n=Object(g.a)(t.state.subArray);n.map((function(e){return e.editing=!1}));var a=n.indexOf(e);n[a].editing=!0,t.updateSubArray(n),T.clog("handleEdit",e,a)},t.handleSubClick=function(e){if(e&&e.start){var n=e.start;t.playerSeekTo(n)}},t.handleSubCancel=function(e){var n=Object(g.a)(t.state.subArray),a=n.indexOf(e);n[a].editing=!1,t.updateSubArray(n)},t.handleSubCommit=function(e,n){var a=Object(g.a)(t.state.subArray),r=a.indexOf(e);a[r]=n,a[r].editing=!1,t.updateSubArray(a,!0),T.clog("\u63d0\u4ea4\uff1a",e,n,a)},t.handleSubInsert=function(e){var n=e?e.end+.001:0,a=Object(g.a)(t.state.subArray),r=a.indexOf(e),o=a[r+1],i=o?Math.abs(o.start-.001):n+5;if(Number((i-n).toFixed(3))<.001)me.notify("\u7a7a\u95f4\u4e0d\u8db3\uff0c\u524d\u540e\u5b57\u5e55\u76f8\u9694\u81f3\u5c11\u9700\u89810.03\u79d2");else{var l=ce.getDefaultSub(Number(n),Number(i));a.splice(r+1,0,l),t.updateSubArray(a);var c=r+1;t.setState({scrollIndex:c}),T.clog("\u63d2\u5165\uff1a",l)}},t.handleSubDownload=Object(x.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce.downloadSubFile();case 3:n=e.sent,T.clog(n),n||me.notify("\u65e0\u5b57\u5e55\u6587\u4ef6\uff0c\u8bf7\u5148\u5236\u4f5c\u60a8\u7684\u5b57\u5e55\u3002"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),me.notify("\u4e0b\u8f7d\u51fa\u9519","top_center","warning");case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),t.handleSubClean=function(){if(window.confirm("\u662f\u5426\u8981\u5220\u9664\u6240\u6709\u5b57\u5e55\uff1f")){t.cleanStorageSubs(),t.updateSubUrl("",!0);t.updateSubArray([])}},t.handlePlayerInit=function(e){T.clog("\u521d\u59cb\u5316\u64ad\u653e\u5668"),t.setState({player:e});mn((function n(){var a=e.video;t.handleCurrentTime(a.currentTime),mn(n)}))},t.playerSeekTo=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pause",a=t.state.player;if(a&&a.video){var r=a.video.duration;a[n]();var o=e>r?r:e;console.log(e,r,o),a.seek(o)}},t.handleVideoSwitch=function(e,n){var a=be.createVideoType(e);URL.revokeObjectURL(t.state.videoUrl),t.setState({videoUrl:n}),t.state.player.switchVideo({url:n,type:a})},t.handleVideoCanPlay=function(){if(T.clog("\u89c6\u9891\u5df2\u7ecf\u5c31\u7eea"),navigator.userAgent.toLowerCase().indexOf("chrome")>0){var e=document.getElementsByClassName("dplayer-subtitle")[0];e&&(e.style.opacity=0)}},t.handleScrollIndexFrame=function(e){t.state.scrollIndex!==e&&t.setState({scrollIndex:e})},t.handleCurrentTime=function(e){t.state.currentTime!==e&&t.setState({currentTime:e},(function(){var n=t.state.subArray.findIndex((function(n){return n.start<=e&&n.end>e}));-1!==n&&t.handleScrollIndexFrame(n)}))},t.handleVideoPlaying=function(){},t.handleWaveClick=function(e,n){t.playerSeekTo(e)},t.handleWaveContextmenu=function(e,n){t.playerSeekTo(e,"play")},t.handleSubBlockMove=function(e,n){var a=Object(g.a)(t.state.subArray),r=a.indexOf(e),o=a[r],i=Number(Number(o.start+n).toFixed(3)),l=Number(Number(o.end+n).toFixed(3));if(!(i<0||l<=0)){var c=Object(h.a)({},o);c.startTime=ce.toTime(i),c.endTime=ce.toTime(l),a[r]=ce.mapSubToFullModel(c),t.updateSubArray(a,!0)}},t.toastId_subBlockMoveError=null,t.handleSubBlockMoveError=function(){me.isActive(t.toastId_subMoveError)||(t.toastId_subBlockMoveError=me.notify(r.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement("div",null,"\u65e0\u6548\u7684\u4f4d\u7f6e\uff0c\u677e\u5f00\u9f20\u6807\u4ee5\u4fee\u590d")),"bottom_left","warning",{hideProgressBar:!0,autoClose:1200,canClose:!0},"flip"))},t.handleSubBlockResize=function(e,n,a){var r=Object(g.a)(t.state.subArray),o=r.indexOf(e),i=r[o],l=Object(h.a)({},i),c=null,s=0;if("start"===a){if(null===(c=Number(Number(i.start+n).toFixed(3)))||c<0)return;l.startTime=ce.toTime(c)}else{if((s=Number(Number(i.end+n).toFixed(3)))<=0||s<=i.start)return;l.endTime=ce.toTime(s)}r[o]=ce.mapSubToFullModel(l),t.updateSubArray(r,!0)},t.handleSubBlockClick=function(e){var n=Object(g.a)(t.state.subArray).indexOf(e);t.setState({scrollIndex:n})},t.handleDurationChange=function(e){t.setState({duration:e})},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.resizeContainer(),this.addResizeListener(),this.initSubTable(),this.subUrlWorker=ce.createSubUrlWorker((function(n){e.updateSubUrl(n,!0)}))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state,n=e.videoUrl,t=e.subUrl,a=e.subArray,o=e.picUrl,i=e.container,l=e.scrollIndex,c=e.player,s=e.currentTime,u=e.duration,d={updateOneState:this.updateOneState,updateSubArray:this.updateSubArray,updateSubUrl:this.updateSubUrl,storageSubs:this.storageSubs,cleanStorageSubs:this.cleanStorageSubs,onDownload:this.handleSubDownload,onClean:this.handleSubClean,onRemove:this.handleSubRemove,onEdit:this.handleSubEdit,onClick:this.handleSubClick,onCommit:this.handleSubCommit,onCancel:this.handleSubCancel,onInsert:this.handleSubInsert,onSwitch:this.handleVideoSwitch,initPlayer:this.handlePlayerInit,onVideoCanPlay:this.handleVideoCanPlay,updateCurrentTime:this.handleCurrentTime,onVideoPlaying:this.handleVideoPlaying,onWaveClick:this.handleWaveClick,onWaveContextmenu:this.handleWaveContextmenu,onSubBlockMove:this.handleSubBlockMove,onSubBlockMoveError:this.handleSubBlockMoveError,onSubBlockResize:this.handleSubBlockResize,onSubBlockClick:this.handleSubBlockClick,onDurationChange:this.handleDurationChange};return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,r.a.createElement("title",null,E.subeditor_title)),r.a.createElement(cn,null),r.a.createElement(Ne,d),r.a.createElement(sn,null,r.a.createElement(un,null,r.a.createElement(Ue,Object.assign({},d,{picUrl:o,videoUrl:n,subUrl:t,player:c})),r.a.createElement(Qe,Object.assign({duration:u},d))),r.a.createElement(dn,null,r.a.createElement(Ye,Object.assign({},d,{container:i,subArray:a,scrollIndex:l})))),r.a.createElement(tn,Object.assign({},d,{currentTime:s,videoUrl:n,subArray:a,duration:u})))}}]),n}(a.Component),bn=function(){return r.a.createElement("div",{className:"container"},r.a.createElement(p.a,null,r.a.createElement("title",null,E.test_title)),r.a.createElement("video",{id:"video",controls:!0,width:"900px",src:"".concat(pe.home,"friday.mp4")},r.a.createElement("track",{default:!0,kind:"subtitles",srcLang:"en",src:"".concat(pe.home,"friday.vtt")})))},fn=(t(225),function(e){function n(){var e,t;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(r)))).state={},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){return me.notify("hello","top_left"),r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,r.a.createElement("meta",{charSet:"utf-8"}),r.a.createElement("title",null,"SH - SubEditor App"),r.a.createElement("link",{rel:"icon",href:"".concat(pe.home,"sh.ico")})),r.a.createElement(b.d,{autoClose:3e3,closeOnClick:!1,draggable:!1,position:b.f.POSITION.TOP_LEFT,className:"toastContainerClass"}),r.a.createElement(f.c,null,r.a.createElement(f.a,{path:pe.trackTest,component:bn}),r.a.createElement(f.a,{path:pe.subEditorPath,component:pn})))}}]),n}(a.Component));t(227),t(228),t(117),t(229),t(230),t(231);i.a.render(r.a.createElement(l.a,null,r.a.createElement(fn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},39:function(e){e.exports=JSON.parse('{"mode":"dev","log":"on","sub_storage_key":"Subs","subeditor_title":"SubEditor - \u5728\u7ebf\u5b57\u5e55\u7f16\u8f91","test_title":"SH - SubEditor Test"}')}},[[132,1,2]]]);
//# sourceMappingURL=main.2db58216.chunk.js.map